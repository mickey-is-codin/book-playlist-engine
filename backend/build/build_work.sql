CREATE TABLE BUILD_WORK AS
    WITH A AS (
        SELECT 
            CAST(ISBN AS INT) AS ISBN,
            CAST(ISBN13 AS INT) AS ISBN13,
            TITLE,
            CAST(WORK_ID AS INT) AS WORK_ID,
            CAST(BOOK_ID AS INT) AS BOOK_ID,
            CAST(AVERAGE_RATING AS FLOAT) AS BOOK_AVERAGE_RATING,
            CAST(TEXT_REVIEWS_COUNT AS INT) AS BOOK_TEXT_REVIEWS_COUNT,
            CAST(RATINGS_COUNT AS INT) AS BOOK_RATINGS_COUNT,
            CAST(NUM_PAGES AS INT) AS NUM_PAGES,
            PUBLISHER,
            CAST(PUBLICATION_YEAR AS INT) AS PUBLICATION_YEAR, -- COMBINE
            CAST(PUBLICATION_MONTH AS INT) AS PUBLICATION_MONTH, -- COMBINE
            CAST(PUBLICATION_DAY AS INT) AS PUBLICATION_DAY, -- COMBINE
            COUNTRY_CODE,
            LANGUAGE_CODE,
            SERIES,
            ASIN,
            KINDLE_ASIN,
            FORMAT,
            CAST(IS_EBOOK AS BOOLEAN) AS IS_EBOOK,
            `DESCRIPTION` AS BOOK_DESC,
            SIMILAR_BOOKS,
            LINK,
            EDITION_INFORMATION,
            `URL` AS BOOK_URL,
            IMAGE_URL,
            TITLE_WITHOUT_SERIES
        FROM IMPORT_BOOKS
        GROUP BY WORK_ID
        HAVING BOOK_RATINGS_COUNT = MAX(BOOK_RATINGS_COUNT)
    ),
    B AS (
        SELECT 
            CAST(AUTHOR_ID AS INT) AS AUTHOR_ID,
            `ROLE` AS AUTHOR_ROLE,
            BOOK_ID
        FROM IMPORT_AUTHORS
        WHERE AUTHOR_ROLE = ''
    ),
    C AS (
        SELECT
            `NAME` AS AUTHOR_NAME,
            AUTHOR_ID,
            AVERAGE_RATING AS AUTHOR_AVERAGE_RATING,
            TEXT_REVIEWS_COUNT AS AUTHOR_TEXT_REVIEWS_COUNT,
            RATINGS_COUNT AS AUTHOR_RATINGS_COUNT
        FROM IMPORT_BOOK_AUTHORS
    )
    SELECT *
    FROM A
    LEFT JOIN B
    USING(BOOK_ID)
    LEFT JOIN C
    USING(AUTHOR_ID);