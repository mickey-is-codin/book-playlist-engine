CREATE TABLE BUILD_WORKS AS
    WITH A AS (
        SELECT
            CAST(AUTHOR_ID AS INT) AS AUTHOR_ID,
            `ROLE` AS AUTHOR_ROLE,
            BOOK_ID
        FROM IMPORT_AUTHORS
        WHERE AUTHOR_ROLE = ''
    ),
    B AS (
        SELECT *
        FROM IMPORT_BOOKS
        GROUP BY WORK_ID
        HAVING (TEXT_REVIEWS_COUNT + RATINGS_COUNT) = MAX(TEXT_REVIEWS_COUNT + RATINGS_COUNT)
    )
    SELECT *
    FROM B
    LEFT JOIN A
    USING(BOOK_ID)
    LEFT JOIN IMPORT_BOOK_AUTHORS
    USING(AUTHOR_ID);